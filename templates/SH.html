<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Session Hijacking / Fixation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Session Hijacking / Fixation</h1>

    <h2>Na czym polega ten atak?</h2>
    <p>
        Atak typu <strong>Session Hijacking</strong> polega na przejęciu cudzej sesji – np. poprzez podejrzenie lub wymuszenie jej identyfikatora.<br><br>
        <strong>Session Fixation</strong> to technika, w której atakujący sam tworzy sesję i „wpycha” ofierze znane sobie ID sesji. Gdy ofiara się zaloguje, atakujący może skorzystać z tej samej sesji.
    </p>

    <h2>Demonstracja – wersja podatna</h2>
    <p>
        Kliknij w poniższy link i przed zalogowaniem dodaj do URL parametr <code>?sid=atak123</code>:<br>
        <code>http://localhost:5000/login-unsafe?sid=atak123</code><br><br>
        Po zalogowaniu sesja zostanie utworzona z tym właśnie identyfikatorem.
    </p>

    <form method="post" action="/login-unsafe">
        <h3>Logowanie (podatne)</h3>
        <input name="username" placeholder="Podaj nazwę użytkownika"><br><br>
        <button>Zaloguj</button>
    </form>

    <p>
        Po zalogowaniu, odwiedź <a href="/profile">/profile</a> i sprawdź ID sesji użytkownika.<br>
        Jeśli ID pochodzi z URL (np. <code>atak123</code>), aplikacja jest podatna na Session Fixation.
    </p>

    <hr>

    <h2>Demonstracja – wersja bezpieczna</h2>
    <p>
        W tej wersji aplikacja czyści starą sesję i tworzy nową, unikalną ID.<br>
        Nie da się wymusić ID sesji przez URL.
    </p>

    <form method="post" action="/login-safe">
        <h3>Logowanie (bezpieczne)</h3>
        <input name="username" placeholder="admin"><br>
        <input type="password" name="password" placeholder="admin"><br><br>
        <button>Zaloguj</button>
    </form>

    <p>
        Po poprawnym logowaniu odwiedź <a href="/profile">/profile</a> i zauważ różnicę w ID sesji – jest bezpieczne i nie pochodzi z zewnętrznych źródeł.
    </p>

    <hr>

    <h2>Wersja po zalogowaniu</h2>
    {% if user %}
        <p><strong>Zalogowany jako:</strong> {{ user }}</p>
        <p><strong>ID sesji:</strong> {{ sid }}</p>
        <a href="/logout-hijack">Wyloguj</a>
    {% else %}
        <p>Nie jesteś zalogowany.</p>
    {% endif %}

    <a href="/" class="back-link">Powrót do strony głównej</a>
</body>
</html>
